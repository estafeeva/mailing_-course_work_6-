# Cервис управления рассылками, администрирования и получения статистики

## Сущности системы
Клиент сервиса:
- контактный email,
- Ф. И. О.,
- комментарий.

- клиенты сервиса — это не пользователи сервиса. Клиенты — это те, кто получает рассылки, а пользователи — те, кто создает эти рассылки.

Рассылка (настройки):
- дата и время первой отправки рассылки;
- периодичность: раз в день, раз в неделю, раз в месяц;
- статус рассылки (например, завершена, создана, запущена).
- Рассылка внутри себя должна содержит ссылки на модели «Сообщения и «Клиенты сервиса». Сообщение у рассылки может быть только одно, а вот клиентов может быть много. Выберите правильные типы связи между моделями.

Сообщение для рассылки:
- тема письма,
- тело письма.
- Сообщения — неотъемлемая часть рассылки. Для них также необходимо реализовать CRUD-механизм!

Попытка рассылки:
- дата и время последней попытки;
- статус попытки (успешно / не успешно);
- ответ почтового сервера, если он был.

## Логика работы системы
1) После создания новой рассылки, если текущие дата и время больше даты и времени начала и меньше даты и времени окончания, должны быть выбраны из справочника все клиенты, которые указаны в настройках рассылки и запущена отправка для всех этих клиентов.
2) Если создается рассылка с временем старта в будущем, отправка должна стартовать автоматически по наступлению этого времени без дополнительных действий со стороны пользователя сервиса.
3) По ходу отправки рассылки должна собираться статистика (см. описание сущностей «Рассылка» и «Попытка» выше) по каждой рассылке для последующего формирования отчетов. Попытка создается одна для одной рассылки. Формировать попытки рассылки для всех клиентов отдельно не нужно.
4) Внешний сервис, который принимает отправляемые сообщения, может долго обрабатывать запрос, отвечать некорректными данными, на какое-то время вообще не принимать запросы. Нужна корректная обработка подобных ошибок. Проблемы с внешним сервисом не должны влиять на стабильность работы разрабатываемого сервиса рассылок.

## Функционал менеджера
- Может просматривать любые рассылки.
- Может просматривать список пользователей сервиса.
- Может блокировать пользователей сервиса.
- Может отключать рассылки.
- Не может редактировать рассылки.
- Не может управлять списком рассылок.
- Не может изменять рассылки и сообщения.

## Блог
Сущность блога:

- заголовок,
- содержимое статьи,
- изображение,
- количество просмотров,
- дата публикации.

## Главная страница

- количество рассылок всего,
- количество активных рассылок,
- количество уникальных клиентов для рассылок,
- три случайные статьи из блога.

## Кеширование

Реализовано для блога и главной страницы.

## Для работы с проектом небходимо:
- Клонировать репозиторий на компьютер используя SSH ключ.
- Создать зависимости, выполнив команду pip install -r requirements.txt.
- В файл .env внести свои данные (необходимые переменные перечислены в файле .env.sample)
- Создать и применить миграции (python manage.py makemigrations, python manage.py migrate)
- Установить Redis и запустить redis-server
- Запустить проект через терминал (команда python manage.py runserver)
- Перейти по адресу: http://127.0.0.1:8000
- На сайте можно зарегистрироваться, добавить сообщение для рассылок, создать клиентов, создать настройки рассылок, добавить статью в блог, посмотреть статистику попыток рассылок
- Для запуска рассылок из терминала можно использовать команду python manage.py run_mailing_sending (перед этим нужно установить в файле .env значение переменной RUN_SCHEDULER=False)